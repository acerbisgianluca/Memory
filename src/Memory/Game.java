/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package Memory;

import java.awt.Image;
import java.io.IOException;
import java.util.Timer;
import java.util.TimerTask;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.imageio.ImageIO;
import javax.swing.ImageIcon;
import javax.swing.JButton;
import javax.swing.JOptionPane;

/**
 *
 * @author Gianluca
 */
public class Game extends javax.swing.JFrame {

    private final int N_CARTE = 16;
    private final Mazzo mazzo;
    
    private final ImageIcon[] icone;
    
    private Image logo;
    
    private final JButton[] pulsanti;
    
    private Boolean prima;
    private Boolean player1;
    private Boolean unLock;
    
    private Carta card1;
    private Carta card2;
    
    private String player1Name;
    private String player2Name;
    
    private int player1Score;
    private int player2Score;
    
    private int round;
    private int player1Round;
    private int player2Round;
    
    /**
     * Creates new form Game
     * @param player1
     * @param player2
     * @param round
     */
    public Game(String player1, String player2, int round) {
        initComponents();
        
        this.player1Name = player1;
        this.player2Name = player2;
        
        this.round = round;
        
        this.player1 = true;
        this.prima = true;
        this.unLock = true;
        
        this.player1Score = 0;
        this.player2Score = 0;
        
        mazzo = new Mazzo (N_CARTE);
        
        icone = new ImageIcon[(N_CARTE / 2) + 1];
        genIcon();
        
        try {
            logo = ImageIO.read(getClass().getResource("/Memory/img/logo.png"));
        } catch (IOException ex) {
            Logger.getLogger(Game.class.getName()).log(Level.SEVERE, null, ex);
        }
        setIconImage(logo);
        
        pulsanti = new JButton[] {btnCard1, btnCard2, btnCard3, btnCard4, btnCard5, btnCard6, btnCard7, btnCard8, btnCard9, btnCard10, btnCard11, btnCard12, btnCard13, btnCard14, btnCard15, btnCard16};
    
        update();
    }
    
    private void genIcon() {
        int i;
        
        for(i = 0; i < (N_CARTE / 2) + 1; i++)
            icone[i] = new ImageIcon(getClass().getResource("/Memory/img/" + i + ".jpg"));
    }
    
    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        panel = new javax.swing.JPanel();
        btnCard1 = new javax.swing.JButton();
        btnCard2 = new javax.swing.JButton();
        btnCard3 = new javax.swing.JButton();
        btnCard4 = new javax.swing.JButton();
        btnCard5 = new javax.swing.JButton();
        btnCard6 = new javax.swing.JButton();
        btnCard7 = new javax.swing.JButton();
        btnCard8 = new javax.swing.JButton();
        btnCard9 = new javax.swing.JButton();
        btnCard10 = new javax.swing.JButton();
        btnCard11 = new javax.swing.JButton();
        btnCard12 = new javax.swing.JButton();
        btnCard13 = new javax.swing.JButton();
        btnCard14 = new javax.swing.JButton();
        btnCard15 = new javax.swing.JButton();
        btnCard16 = new javax.swing.JButton();
        lblPlayer2 = new javax.swing.JLabel();
        lblPlayer1 = new javax.swing.JLabel();
        lblTurno = new javax.swing.JLabel();
        btnReset = new javax.swing.JButton();
        lblPlayer1Round = new javax.swing.JLabel();
        lblPlayer2Round = new javax.swing.JLabel();
        lblReset = new javax.swing.JLabel();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setTitle("Memory: OverWatch Edition");
        setIconImages(null);
        setResizable(false);

        panel.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        btnCard1.setFont(new java.awt.Font("Dialog", 0, 24)); // NOI18N
        btnCard1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Memory/img/8.jpg"))); // NOI18N
        btnCard1.setPreferredSize(new java.awt.Dimension(100, 100));
        btnCard1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCard1ActionPerformed(evt);
            }
        });
        panel.add(btnCard1, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 99, -1, 150));

        btnCard2.setFont(new java.awt.Font("Dialog", 0, 24)); // NOI18N
        btnCard2.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Memory/img/8.jpg"))); // NOI18N
        btnCard2.setPreferredSize(new java.awt.Dimension(100, 100));
        btnCard2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCard2ActionPerformed(evt);
            }
        });
        panel.add(btnCard2, new org.netbeans.lib.awtextra.AbsoluteConstraints(128, 99, -1, 150));

        btnCard3.setFont(new java.awt.Font("Dialog", 0, 24)); // NOI18N
        btnCard3.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Memory/img/8.jpg"))); // NOI18N
        btnCard3.setPreferredSize(new java.awt.Dimension(100, 100));
        btnCard3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCard3ActionPerformed(evt);
            }
        });
        panel.add(btnCard3, new org.netbeans.lib.awtextra.AbsoluteConstraints(246, 99, -1, 150));

        btnCard4.setFont(new java.awt.Font("Dialog", 0, 24)); // NOI18N
        btnCard4.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Memory/img/8.jpg"))); // NOI18N
        btnCard4.setPreferredSize(new java.awt.Dimension(100, 100));
        btnCard4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCard4ActionPerformed(evt);
            }
        });
        panel.add(btnCard4, new org.netbeans.lib.awtextra.AbsoluteConstraints(364, 99, -1, 150));

        btnCard5.setFont(new java.awt.Font("Dialog", 0, 24)); // NOI18N
        btnCard5.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Memory/img/8.jpg"))); // NOI18N
        btnCard5.setPreferredSize(new java.awt.Dimension(100, 100));
        btnCard5.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCard5ActionPerformed(evt);
            }
        });
        panel.add(btnCard5, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 267, -1, 150));

        btnCard6.setFont(new java.awt.Font("Dialog", 0, 24)); // NOI18N
        btnCard6.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Memory/img/8.jpg"))); // NOI18N
        btnCard6.setPreferredSize(new java.awt.Dimension(100, 100));
        btnCard6.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCard6ActionPerformed(evt);
            }
        });
        panel.add(btnCard6, new org.netbeans.lib.awtextra.AbsoluteConstraints(128, 267, -1, 150));

        btnCard7.setFont(new java.awt.Font("Dialog", 0, 24)); // NOI18N
        btnCard7.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Memory/img/8.jpg"))); // NOI18N
        btnCard7.setPreferredSize(new java.awt.Dimension(100, 100));
        btnCard7.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCard7ActionPerformed(evt);
            }
        });
        panel.add(btnCard7, new org.netbeans.lib.awtextra.AbsoluteConstraints(246, 267, -1, 150));

        btnCard8.setFont(new java.awt.Font("Dialog", 0, 24)); // NOI18N
        btnCard8.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Memory/img/8.jpg"))); // NOI18N
        btnCard8.setPreferredSize(new java.awt.Dimension(100, 100));
        btnCard8.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCard8ActionPerformed(evt);
            }
        });
        panel.add(btnCard8, new org.netbeans.lib.awtextra.AbsoluteConstraints(364, 267, -1, 150));

        btnCard9.setFont(new java.awt.Font("Dialog", 0, 24)); // NOI18N
        btnCard9.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Memory/img/8.jpg"))); // NOI18N
        btnCard9.setPreferredSize(new java.awt.Dimension(100, 100));
        btnCard9.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCard9ActionPerformed(evt);
            }
        });
        panel.add(btnCard9, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 435, -1, 150));

        btnCard10.setFont(new java.awt.Font("Dialog", 0, 24)); // NOI18N
        btnCard10.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Memory/img/8.jpg"))); // NOI18N
        btnCard10.setPreferredSize(new java.awt.Dimension(100, 100));
        btnCard10.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCard10ActionPerformed(evt);
            }
        });
        panel.add(btnCard10, new org.netbeans.lib.awtextra.AbsoluteConstraints(128, 435, -1, 150));

        btnCard11.setFont(new java.awt.Font("Dialog", 0, 24)); // NOI18N
        btnCard11.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Memory/img/8.jpg"))); // NOI18N
        btnCard11.setPreferredSize(new java.awt.Dimension(100, 100));
        btnCard11.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCard11ActionPerformed(evt);
            }
        });
        panel.add(btnCard11, new org.netbeans.lib.awtextra.AbsoluteConstraints(246, 435, -1, 150));

        btnCard12.setFont(new java.awt.Font("Dialog", 0, 24)); // NOI18N
        btnCard12.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Memory/img/8.jpg"))); // NOI18N
        btnCard12.setPreferredSize(new java.awt.Dimension(100, 100));
        btnCard12.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCard12ActionPerformed(evt);
            }
        });
        panel.add(btnCard12, new org.netbeans.lib.awtextra.AbsoluteConstraints(364, 435, -1, 150));

        btnCard13.setFont(new java.awt.Font("Dialog", 0, 24)); // NOI18N
        btnCard13.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Memory/img/8.jpg"))); // NOI18N
        btnCard13.setPreferredSize(new java.awt.Dimension(100, 100));
        btnCard13.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCard13ActionPerformed(evt);
            }
        });
        panel.add(btnCard13, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 603, -1, 150));

        btnCard14.setFont(new java.awt.Font("Dialog", 0, 24)); // NOI18N
        btnCard14.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Memory/img/8.jpg"))); // NOI18N
        btnCard14.setPreferredSize(new java.awt.Dimension(100, 100));
        btnCard14.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCard14ActionPerformed(evt);
            }
        });
        panel.add(btnCard14, new org.netbeans.lib.awtextra.AbsoluteConstraints(128, 603, -1, 150));

        btnCard15.setFont(new java.awt.Font("Dialog", 0, 24)); // NOI18N
        btnCard15.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Memory/img/8.jpg"))); // NOI18N
        btnCard15.setPreferredSize(new java.awt.Dimension(100, 100));
        btnCard15.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCard15ActionPerformed(evt);
            }
        });
        panel.add(btnCard15, new org.netbeans.lib.awtextra.AbsoluteConstraints(246, 603, -1, 150));

        btnCard16.setFont(new java.awt.Font("Dialog", 0, 24)); // NOI18N
        btnCard16.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Memory/img/8.jpg"))); // NOI18N
        btnCard16.setPreferredSize(new java.awt.Dimension(100, 100));
        btnCard16.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCard16ActionPerformed(evt);
            }
        });
        panel.add(btnCard16, new org.netbeans.lib.awtextra.AbsoluteConstraints(364, 603, -1, 150));

        lblPlayer2.setFont(new java.awt.Font("Dialog", 0, 12)); // NOI18N
        lblPlayer2.setText("PUNTEGGIO GIOCATORE 2: 0");
        panel.add(lblPlayer2, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 40, -1, -1));

        lblPlayer1.setFont(new java.awt.Font("Dialog", 0, 12)); // NOI18N
        lblPlayer1.setText("PUNTEGGIO GIOCATORE 1: 0");
        panel.add(lblPlayer1, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 13, -1, -1));

        lblTurno.setFont(new java.awt.Font("Dialog", 1, 14)); // NOI18N
        lblTurno.setForeground(new java.awt.Color(255, 0, 0));
        lblTurno.setText("TURNO GIOCATORE: 1");
        panel.add(lblTurno, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 74, -1, -1));

        btnReset.setText("Reset");
        btnReset.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnResetActionPerformed(evt);
            }
        });
        panel.add(btnReset, new org.netbeans.lib.awtextra.AbsoluteConstraints(403, 11, -1, -1));

        lblPlayer1Round.setText("Round vinti: 0");
        panel.add(lblPlayer1Round, new org.netbeans.lib.awtextra.AbsoluteConstraints(279, 15, -1, -1));

        lblPlayer2Round.setText("Round vinti: 0");
        panel.add(lblPlayer2Round, new org.netbeans.lib.awtextra.AbsoluteConstraints(279, 42, -1, -1));

        lblReset.setFont(new java.awt.Font("Dialog", 1, 12)); // NOI18N
        lblReset.setForeground(new java.awt.Color(0, 0, 255));
        lblReset.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lblReset.setName(""); // NOI18N
        panel.add(lblReset, new org.netbeans.lib.awtextra.AbsoluteConstraints(279, 74, -1, -1));

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(panel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addContainerGap())
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(panel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addContainerGap())
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void btnResetActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnResetActionPerformed
        reset();
    }//GEN-LAST:event_btnResetActionPerformed

    private void btnCard1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCard1ActionPerformed
        if(prima) {
            card1 = mazzo.cercaCarta(0);
            btnCard1.setIcon(icone[card1.getCode()]);
            prima = false;
        }
        else if (unLock && card1.getPos() != 0) {
            unLock = false;
            card2 = mazzo.cercaCarta(0);
            btnCard1.setIcon(icone[card2.getCode()]);
            if(card1.equals(card2)) {
                if(player1)
                    player1Score++;
                else
                    player2Score++;
                
                nascondi();
            }
            else {
                gira();
            }
        }
        
        update();
    }//GEN-LAST:event_btnCard1ActionPerformed

    private void btnCard4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCard4ActionPerformed
        if(prima) {
            card1 = mazzo.cercaCarta(3);
            btnCard4.setIcon(icone[card1.getCode()]);
            prima = false;
        }
        else if (unLock && card1.getPos() != 3) {
            unLock = false;
            card2 = mazzo.cercaCarta(3);
            btnCard4.setIcon(icone[card2.getCode()]);
            if(card1.equals(card2)) {
                if(player1)
                    player1Score++;
                else
                    player2Score++;
                
                nascondi();
            }
            else {
                gira();
            }
        }
        
        update();
    }//GEN-LAST:event_btnCard4ActionPerformed

    private void btnCard11ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCard11ActionPerformed
        if(prima) {
            card1 = mazzo.cercaCarta(10);
            btnCard11.setIcon(icone[card1.getCode()]);
            prima = false;
        }
        else if (unLock && card1.getPos() != 10) {
            unLock = false;
            card2 = mazzo.cercaCarta(10);
            btnCard11.setIcon(icone[card2.getCode()]);
            if(card1.equals(card2)) {
                if(player1)
                    player1Score++;
                else
                    player2Score++;
                
                nascondi();
            }
            else {
                gira();
            }
        }
        
        update();
    }//GEN-LAST:event_btnCard11ActionPerformed

    private void btnCard2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCard2ActionPerformed
        if(prima) {
            card1 = mazzo.cercaCarta(1);
            btnCard2.setIcon(icone[card1.getCode()]);
            prima = false;
        }
        else if (unLock && card1.getPos() != 1) {
            unLock = false;
            card2 = mazzo.cercaCarta(1);
            btnCard2.setIcon(icone[card2.getCode()]);
            if(card1.equals(card2)) {
                if(player1)
                    player1Score++;
                else
                    player2Score++;
                
                nascondi();
            }
            else {
                gira();
            }
        }
        
        update();
    }//GEN-LAST:event_btnCard2ActionPerformed

    private void btnCard3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCard3ActionPerformed
        if(prima) {
            card1 = mazzo.cercaCarta(2);
            btnCard3.setIcon(icone[card1.getCode()]);
            prima = false;
        }
        else if (unLock && card1.getPos() != 2) {
            unLock = false;
            card2 = mazzo.cercaCarta(2);
            btnCard3.setIcon(icone[card2.getCode()]);
            if(card1.equals(card2)) {
                if(player1)
                    player1Score++;
                else
                    player2Score++;
                
                nascondi();
            }
            else {
                gira();
            }
        }
        
        update();
    }//GEN-LAST:event_btnCard3ActionPerformed

    private void btnCard5ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCard5ActionPerformed
        if(prima) {
            card1 = mazzo.cercaCarta(4);
            btnCard5.setIcon(icone[card1.getCode()]);
            prima = false;
        }
        else if (unLock && card1.getPos() != 4) {
            unLock = false;
            card2 = mazzo.cercaCarta(4);
            btnCard5.setIcon(icone[card2.getCode()]);
            if(card1.equals(card2)) {
                if(player1)
                    player1Score++;
                else
                    player2Score++;
                
                nascondi();
            }
            else {
                gira();
            }
        }
        
        update();
    }//GEN-LAST:event_btnCard5ActionPerformed

    private void btnCard6ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCard6ActionPerformed
        if(prima) {
            card1 = mazzo.cercaCarta(5);
            btnCard6.setIcon(icone[card1.getCode()]);
            prima = false;
        }
        else if (unLock && card1.getPos() != 5) {
            unLock = false;
            card2 = mazzo.cercaCarta(5);
            btnCard6.setIcon(icone[card2.getCode()]);
            if(card1.equals(card2)) {
                if(player1)
                    player1Score++;
                else
                    player2Score++;
                
                nascondi();
            }
            else {
                gira();
            }
        }
        
        update();
    }//GEN-LAST:event_btnCard6ActionPerformed

    private void btnCard7ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCard7ActionPerformed
        if(prima) {
            card1 = mazzo.cercaCarta(6);
            btnCard7.setIcon(icone[card1.getCode()]);
            prima = false;
        }
        else if (unLock && card1.getPos() != 6) {
            unLock = false;
            card2 = mazzo.cercaCarta(6);
            btnCard7.setIcon(icone[card2.getCode()]);
            if(card1.equals(card2)) {
                if(player1)
                    player1Score++;
                else
                    player2Score++;
                
                nascondi();
            }
            else {
                gira();
            }
        }
        
        update();
    }//GEN-LAST:event_btnCard7ActionPerformed

    private void btnCard8ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCard8ActionPerformed
        if(prima) {
            card1 = mazzo.cercaCarta(7);
            btnCard8.setIcon(icone[card1.getCode()]);
            prima = false;
        }
        else if (unLock && card1.getPos() != 7) {
            unLock = false;
            card2 = mazzo.cercaCarta(7);
            btnCard8.setIcon(icone[card2.getCode()]);
            if(card1.equals(card2)) {
                if(player1)
                    player1Score++;
                else
                    player2Score++;
                
                nascondi();
            }
            else {
                gira();
            }
        }
        
        update();
    }//GEN-LAST:event_btnCard8ActionPerformed

    private void btnCard9ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCard9ActionPerformed
        if(prima) {
            card1 = mazzo.cercaCarta(8);
            btnCard9.setIcon(icone[card1.getCode()]);
            prima = false;
        }
        else if (unLock && card1.getPos() != 8) {
            unLock = false;
            card2 = mazzo.cercaCarta(8);
            btnCard9.setIcon(icone[card2.getCode()]);
            if(card1.equals(card2)) {
                if(player1)
                    player1Score++;
                else
                    player2Score++;
                
                nascondi();
            }
            else {
                gira();
            }
        }
        
        update();
    }//GEN-LAST:event_btnCard9ActionPerformed

    private void btnCard10ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCard10ActionPerformed
        if(prima) {
            card1 = mazzo.cercaCarta(9);
            btnCard10.setIcon(icone[card1.getCode()]);
            prima = false;
        }
        else if (unLock && card1.getPos() != 9) {
            unLock = false;
            card2 = mazzo.cercaCarta(9);
            btnCard10.setIcon(icone[card2.getCode()]);
            if(card1.equals(card2)) {
                if(player1)
                    player1Score++;
                else
                    player2Score++;
                
                nascondi();
            }
            else {
                gira();
            }
        }
        
        update();
    }//GEN-LAST:event_btnCard10ActionPerformed

    private void btnCard12ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCard12ActionPerformed
        if(prima) {
            card1 = mazzo.cercaCarta(11);
            btnCard12.setIcon(icone[card1.getCode()]);
            prima = false;
        }
        else if (unLock && card1.getPos() != 11) {
            unLock = false;
            card2 = mazzo.cercaCarta(11);
            btnCard12.setIcon(icone[card2.getCode()]);
            if(card1.equals(card2)) {
                if(player1)
                    player1Score++;
                else
                    player2Score++;
                
                nascondi();
            }
            else {
                gira();
            }
        }
        
        update();
    }//GEN-LAST:event_btnCard12ActionPerformed

    private void btnCard13ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCard13ActionPerformed
        if(prima) {
            card1 = mazzo.cercaCarta(12);
            btnCard13.setIcon(icone[card1.getCode()]);
            prima = false;
        }
        else if (unLock && card1.getPos() != 12) {
            unLock = false;
            card2 = mazzo.cercaCarta(12);
            btnCard13.setIcon(icone[card2.getCode()]);
            if(card1.equals(card2)) {
                if(player1)
                    player1Score++;
                else
                    player2Score++;
                
                nascondi();
            }
            else {
                gira();
            }
        }
        
        update();
    }//GEN-LAST:event_btnCard13ActionPerformed

    private void btnCard14ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCard14ActionPerformed
        if(prima) {
            card1 = mazzo.cercaCarta(13);
            btnCard14.setIcon(icone[card1.getCode()]);
            prima = false;
        }
        else if (unLock && card1.getPos() != 13) {
            unLock = false;
            card2 = mazzo.cercaCarta(13);
            btnCard14.setIcon(icone[card2.getCode()]);
            if(card1.equals(card2)) {
                if(player1)
                    player1Score++;
                else
                    player2Score++;
                
                nascondi();
            }
            else {
                gira();
            }
        }
        
        update();
    }//GEN-LAST:event_btnCard14ActionPerformed

    private void btnCard15ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCard15ActionPerformed
        if(prima) {
            card1 = mazzo.cercaCarta(14);
            btnCard15.setIcon(icone[card1.getCode()]);
            prima = false;
        }
        else if (unLock && card1.getPos() != 14) {
            unLock = false;
            card2 = mazzo.cercaCarta(14);
            btnCard15.setIcon(icone[card2.getCode()]);
            if(card1.equals(card2)) {
                if(player1)
                    player1Score++;
                else
                    player2Score++;
                
                nascondi();
            }
            else {
                gira();
            }
        }
        
        update();
    }//GEN-LAST:event_btnCard15ActionPerformed

    private void btnCard16ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCard16ActionPerformed
        if(prima) {
            card1 = mazzo.cercaCarta(15);
            btnCard16.setIcon(icone[card1.getCode()]);
            prima = false;
        }
        else if (unLock && card1.getPos() != 15) {
            unLock = false;
            card2 = mazzo.cercaCarta(15);
            btnCard16.setIcon(icone[card2.getCode()]);
            if(card1.equals(card2)) {
                if(player1)
                    player1Score++;
                else
                    player2Score++;
                
                nascondi();
            }
            else {
                gira();
            }
        }
        
        update();
    }//GEN-LAST:event_btnCard16ActionPerformed

    public void nascondi () {
        pulsanti[card1.getPos()].setEnabled(false);
        pulsanti[card2.getPos()].setEnabled(false);
        
        card1 = null;
        card2 = null;

        unLock = true;
        prima = true;
        
        if(player1Score + player2Score != 8)
            update();
    }
    
    public void gira () {
        Timer timer = new Timer();
        timer.schedule(new TimerTask() {
            @Override
            public void run(){
                pulsanti[card1.getPos()].setIcon(icone[8]);
                pulsanti[card2.getPos()].setIcon(icone[8]);
                
                card1 = null;
                card2 = null;
                player1 = !player1;
                
                update();
                
                timer.cancel();
                
                unLock = true;
                prima = true;
            }
        }, 3000);
    }
    
    public void update () {
        if(player1Score + player2Score == 8){
            if(player1Score > player2Score){
                lblPlayer1.setText("Punteggio di " + player1Name + ": " + player1Score);
                player1Round++;
                lblPlayer1Round.setText("Round vinti: " + player1Round);
                if(player1Round == (round / 2) + 1)
                    JOptionPane.showMessageDialog(rootPane, player1Name + " ha vinto!", "WINNER WINNER CHICKEN DINNER", 1);
            }
            else {
                lblPlayer2.setText("Punteggio di " + player2Name + ": " + player2Score);
                player2Round++;
                lblPlayer2Round.setText("Round vinti: " + player2Round);
                if(player2Round == (round / 2) + 1)
                    JOptionPane.showMessageDialog(rootPane, player2Name + " ha vinto!", "WINNER WINNER CHICKEN DINNER", 1);
            }
            
            if(player1Round == (round / 2) + 1 || player2Round == (round / 2) + 1)
                lblReset.setText("Il campo è stato rigenerato!");

            reset();
        }
        else {
            lblPlayer1.setText("Punteggio di " + player1Name + ": " + player1Score);
            lblPlayer2.setText("Punteggio di " + player2Name + ": " + player2Score);
            
            lblPlayer1Round.setText("Round vinti: " + player1Round);
            lblPlayer2Round.setText("Round vinti: " + player2Round);
            
            if(player1)
                lblTurno.setText("Turno di " + player1Name);
            else
                lblTurno.setText("Turno di " + player2Name);
        } 
    }
    
    public void reset() {
        System.out.println("");

        mazzo.reset();
        mazzo.genMazzo();

        this.player1Score = 0;
        this.player2Score = 0;

        this.prima = true;
        this.player1 = true;
        this.unLock = true;

        this.card1 = null;
        this.card2 = null;

        if(player1Round == (round / 2) + 1 || player2Round == (round / 2) + 1) {
            player1Round = 0;
            player2Round = 0;
        }
        else
            lblReset.setText("");
        
        for(int i = 0; i < N_CARTE; i++) {
            pulsanti[i].setEnabled(true);
            pulsanti[i].setIcon(icone[8]);
        }

        update();
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnCard1;
    private javax.swing.JButton btnCard10;
    private javax.swing.JButton btnCard11;
    private javax.swing.JButton btnCard12;
    private javax.swing.JButton btnCard13;
    private javax.swing.JButton btnCard14;
    private javax.swing.JButton btnCard15;
    private javax.swing.JButton btnCard16;
    private javax.swing.JButton btnCard2;
    private javax.swing.JButton btnCard3;
    private javax.swing.JButton btnCard4;
    private javax.swing.JButton btnCard5;
    private javax.swing.JButton btnCard6;
    private javax.swing.JButton btnCard7;
    private javax.swing.JButton btnCard8;
    private javax.swing.JButton btnCard9;
    private javax.swing.JButton btnReset;
    private javax.swing.JLabel lblPlayer1;
    private javax.swing.JLabel lblPlayer1Round;
    private javax.swing.JLabel lblPlayer2;
    private javax.swing.JLabel lblPlayer2Round;
    private javax.swing.JLabel lblReset;
    private javax.swing.JLabel lblTurno;
    private javax.swing.JPanel panel;
    // End of variables declaration//GEN-END:variables
}
